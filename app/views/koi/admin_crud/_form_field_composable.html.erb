<%-
  value = f.object.send(attr)
  # fix for data not saving in JSON format
  if value.is_a?(String)
    value = JSON.parse(value)
  end
-%>

<%= react_component("KoiComposable", props: {
  composition: value,
  config: f.object.class.composable_config,
  allComposableTypes: Koi::ComposableContent.components,
  showAdvancedSettings: Koi::ComposableContent.show_advanced_settings,
  icons: {
    image: icon("image"),
    stack: icon("stack"),
    folder: icon("folder"),
    comment: icon("comment"),
    menu: icon("menu"),
    module: icon("module"),
    visible: icon("visible"),
    hidden: icon("hidden"),
    code: icon("code"),
    paragraph: icon("paragraph"),
    paragraph_with_image: icon("paragraph_with_image"),
    composable_section: icon("composable_section"),
    listing_blocks: icon("listing_blocks"),
    heading: icon("heading"),
    user: icon("user"),
    cog: icon("cog_filled"),
  },
  formFieldName: "#{f.object_name}[#{attr}]",
  debug: false,
}) %>
