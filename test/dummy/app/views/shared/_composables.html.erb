<%- sections.each do |section| -%>

  <%- # Build mark up for the data inside this section for use later -%>
  <%- section_contents = capture do -%>
    <%- section[:section_data].each do |component| -%>
      <%- component_type = component["component_type"] -%>
      <%= 
        begin
          render "shared/composable_components/#{component_type}", data: component 
        rescue ActionView::MissingTemplate
          "Unknown component type: #{component_type}"
        end
      -%>
    <%- end -%>
  <%- end -%>

  <%- # Build markup for our section and insert our data -%>
  <%- section_type = section[:section_type] -%>
  <%= 
    begin
      render "shared/composable_sections/#{section_type}", section: section, section_contents: section_contents 
    rescue ActionView::MissingTemplate
      render "shared/composable_sections/default", section: section, section_contents: section_contents 
    end
  -%>

<%- end -%>
